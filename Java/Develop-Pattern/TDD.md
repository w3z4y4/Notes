## TDD(Test-Driven Development)---20180829
### 简介
TDD是测试驱动开发(Test-Driven Development)的英文简称。TDD的核心是：先写测试，并使用它帮助开发人员来驱动软件开发。

首先是先写测试，这里的测试并不只是单元测试，也不是说一定要使用mock和stub来做测试。这里的测试就是指软件测试本身，可以是基于代码单元的单元测试，可以是基于业务需求的功能测试，也可以是基于特定验收条件的验收测试。

其次是帮助开发人员，主要是帮助开发人员理解软件的功能需求和验收条件，帮助其思考和设计代码，从而达到驱动开发的目的，所以TDD是包含两部分：ATDD与UTDD。

ATDD（Acceptance Test Driven Development）：验收驱动测试开发，首先BA或者QA编写验收测试用例，然后Dev通过验收测试来理解需求和验收条件，并编写实现代码直到验收测试用例通过。

由于验收方法和类型也是多种多样的，所以根据验收方法和类型的不同，ATDD其实是包含BDD（Behavior Driven Development）、EDD（Example Driven Development），FDD（Feature Driven Development）、CDCD（Consumer Driven Contract Development）等各种的实践方法。

比如以软件的行为为验收标准，这个是BDD；如果以特定的实例数据为验收标准，这个是EDD；如果以Web Service API消费者提出API契约来驱动API提供者开发API，这个是CDCD等。所以ATDD的具体实现需要结合项目的实际情况来选用适合的验收测试方法与类型。

UTDD（Unit Test Driven Development）：单元驱动测试开发，首先Dev编写单元测试用例，然后编写实现代码直到单元测试通过。这个就是现在很多人所谓的TDD、实践的TDD、喜欢的TDD、抱怨的TDD，但是它却只是真正意义上TDD的一部分而已。

### TDD实施关键
三定律：

　　1、在编写不能通过的单元测试前,不可编写生产代码。

　　2、只可编写刚好无法通过的单元测试,不能编译也算不通过。

　　3、只可编写刚好足以通过当前失败测试的生产代码。

　　总的来说就是先写测试再写生产代码，写一个测试就应该立即写它的实现代码。
  
  怎么做TDD（关键5步）

1.加入一个新的测试

2.运行下新加的测试，看到它失败（因为你还没写功能代码）

3.对开发代码做很小的修改，目的就是让新加的测试通过 （注意这里的目的）

4.运行所有的测试（test case），然后看到所有测试都通过了 （看到测试都变成绿色，一般都会小开心一下）

5.移掉重复的代码，对代码进行重构 （既包括功能代码，也包括测试代码。特别注意红色的字串 一般会有重复，还有一些代码可以抽出来变成公用方法，测试代码中同样的初始化和还原测试环境的代码，可以放到intilize和cleanup中去）

   而外还有一些步骤也是可以加入的，比方

在写测试代码前，先从需求出发，准备一个Test list (需要测到的功能的列表)。忘掉你该怎么实现，那是后面的事情。
每测完一个就用横线划掉。
如果发现有漏掉的test 就加到这个列表中（列表测完你的功能也就完成了）。

TDD单元测试遵循的规则

　　（1）单个测试中断言数量应该最小化，可以快速方便地理解其结论。

　　（2）每个测试一个概念，即每个测试函数只做一件事。

　　（3）F.I.R.S.T原则

　　　　快    速（First）：能够快速运行。

　　　　独    立（Independence）：可单独运行每个测试，也就是说可以任何顺序运行测试。不同代码的测试应该相互独立，例如一个类对应一个测试类。

　　　　可重复（Repeat）：在任何环境中测试均能通过。

　　　　自动验证（Spontaneous Verification）：应有布尔值输出。

　　　　及    时（Timely）：应在生产代码之前编写。

总结：

1.T的目的是用来映射现实生活中的需求，目的是做需求分析和设计，和 QA 没有太大关系。重要的是你的 T 是否在反映你的设计，你的接口。

2.小步慢跑的开发模式。特别对于复杂业务逻辑的项目，以小步慢走的方式，避免后面繁重的测试和维护工作，小步前进是降低复杂性的好办法。小步慢跑的开发模式驱动代码的再设计和重构,在测试的保护下,通过去除冗余的代码,提高代码质量。

3.测试代码好好组织还很有利于文档化。在介绍你的代码如何使用时，可以通过将文档链接到相关的测试例上，让调用者对代码的使用有个更清晰地认知。

更好的方式是 doctest —— 在代码的文档部分，嵌入如何调用该代码的示例代码，这部分代码进而变成测试的一部分。doctest 早先见于 python，现在几乎所有语言都有工具支持。TDD 的用户层接口可以考虑使用 doctest 完成 test case 的撰写。

